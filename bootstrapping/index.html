<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/robut.ico">

        <title>Bootstrapping - Maxwell's Daemon</title>

        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/bootstrap-theme.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/prettify-1.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.5.2/respond.min.js"></script>
        <![endif]-->
        <script src="http://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">Maxwell's Daemon</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="..">Overview</a>
                </li>
            
            
            
                <li >
                    <a href="../quickstart/">Quick Start</a>
                </li>
            
            
            
                <li >
                    <a href="../config/">Configuration</a>
                </li>
            
            
            
                <li >
                    <a href="../producers/">Producers</a>
                </li>
            
            
            
                <li >
                    <a href="../filtering/">Filtering</a>
                </li>
            
            
            
                <li >
                    <a href="../dataformat/">Data Format</a>
                </li>
            
            
            
                <li >
                    <a href="../encryption/">Encryption</a>
                </li>
            
            
            
                <li class="active">
                    <a href="./">Bootstrapping</a>
                </li>
            
            
            
                <li >
                    <a href="../monitoring/">Monitoring</a>
                </li>
            
            
            
                <li >
                    <a href="../embedding/">Embedding</a>
                </li>
            
            
            
                <li >
                    <a href="../schemas/">Schemas</a>
                </li>
            
            
            
                <li >
                    <a href="../compat/">Compat / Caveats</a>
                </li>
            
            
            
                <li >
                    <a href="../changelog/">Changelog</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../encryption/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../monitoring/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
            <div class="navbar-image-container"><img id="navbar-image" src="/img/maxwell_equals_2.png"></div>
        </div>
    </div>
</div>

        <a href="https://github.com/zendesk/maxwell"><img id="github-banner" style="position: absolute; top: 0; right: 0; border: 0; z-index: 1031;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
        <div class="container">
            <div class="col-md-2">&nbsp;<div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        
          <li >
              <a href="..">Overview</a>
              
          </li>
        
          <li >
              <a href="../quickstart/">Quick Start</a>
              
          </li>
        
          <li >
              <a href="../config/">Configuration</a>
              
          </li>
        
          <li >
              <a href="../producers/">Producers</a>
              
          </li>
        
          <li >
              <a href="../filtering/">Filtering</a>
              
          </li>
        
          <li >
              <a href="../dataformat/">Data Format</a>
              
          </li>
        
          <li >
              <a href="../encryption/">Encryption</a>
              
          </li>
        
          <li class="active">
              <a href="./">Bootstrapping</a>
              
                  <ul class="nav">
                  
                      <li class="toctree-l3"><a href="#using-the-maxwell-bootstrap-utility">Using the maxwell-bootstrap utility</a>
                      <ul class="toctree-subnav">
                      
                      </li>
                      </uL>
                  
                      <li class="toctree-l3"><a href="#using-the-maxwellbootstrap-table">Using the maxwell.bootstrap table</a>
                      <ul class="toctree-subnav">
                      
                      </li>
                      </uL>
                  
                      <li class="toctree-l3"><a href="#async-vs-sync-bootstrapping">Async vs Sync bootstrapping</a>
                      <ul class="toctree-subnav">
                      
                      </li>
                      </uL>
                  
                      <li class="toctree-l3"><a href="#bootstrapping-data-format">Bootstrapping Data Format</a>
                      <ul class="toctree-subnav">
                      
                      </li>
                      </uL>
                  
                      <li class="toctree-l3"><a href="#failure-scenarios">Failure Scenarios</a>
                      <ul class="toctree-subnav">
                      
                      </li>
                      </uL>
                  
                  </ul>
              
          </li>
        
          <li >
              <a href="../monitoring/">Monitoring</a>
              
          </li>
        
          <li >
              <a href="../embedding/">Embedding</a>
              
          </li>
        
          <li >
              <a href="../schemas/">Schemas</a>
              
          </li>
        
          <li >
              <a href="../compat/">Compat / Caveats</a>
              
          </li>
        
          <li >
              <a href="../changelog/">Changelog</a>
              
          </li>
        
    </ul>
</div></div>
            <div class="col-md-10" role="main">

<h3 id="using-the-maxwell-bootstrap-utility">Using the maxwell-bootstrap utility</h3>
<hr />
<p>You can use the <code>maxwell-bootstrap</code> utility to bootstrap tables from the command-line.</p>
<table>
<thead>
<tr>
<th>option</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>--log_level LOG_LEVEL</td>
<td>log level (DEBUG, INFO, WARN or ERROR)</td>
</tr>
<tr>
<td>--user USER</td>
<td>mysql username</td>
</tr>
<tr>
<td>--password PASSWORD</td>
<td>mysql password</td>
</tr>
<tr>
<td>--host HOST</td>
<td>mysql host</td>
</tr>
<tr>
<td>--port PORT</td>
<td>mysql port</td>
</tr>
<tr>
<td>--database DATABASE</td>
<td>mysql database containing the table to bootstrap</td>
</tr>
<tr>
<td>--table TABLE</td>
<td>mysql table to bootstrap</td>
</tr>
<tr>
<td>--where WHERE_CLAUSE</td>
<td>where clause to restrict the rows bootstrapped from the specified table</td>
</tr>
<tr>
<td>--client_id CLIENT_ID</td>
<td>specify which maxwell instance should perform the bootstrap operation</td>
</tr>
</tbody>
</table>
<h3 id="using-the-maxwellbootstrap-table">Using the maxwell.bootstrap table</h3>
<hr />
<p>Alternatively you can insert a row in the <code>maxwell.bootstrap</code> table to trigger a bootstrap.</p>
<pre><code>mysql&gt; insert into maxwell.bootstrap (database_name, table_name) values ('fooDB', 'barTable');
</code></pre>

<p>Optionally, you can include a where clause to replay part of the data.</p>
<p>bin/maxwell-bootstrap --config localhost.properties --database foobar --table test --log_level info</p>
<p>or</p>
<p>bin/maxwell-bootstrap --config localhost.properties --database foobar --table test --where "my_date &gt;= '2017-01-07 00:00:00'" --log_level info</p>
<h3 id="async-vs-sync-bootstrapping">Async vs Sync bootstrapping</h3>
<hr />
<p>The Maxwell replicator is single threaded; events are captured by one thread from the binlog and replicated to Kafka one message at a time.
When running Maxwell with <code>--bootstrapper=sync</code>, the same thread is used to do bootstrapping, meaning that all binlog events are blocked until bootstrapping is complete.
Running Maxwell with <code>--bootstrapper=async</code> however, will make Maxwell spawn a separate thread for bootstrapping.
In this async mode, non-bootstrapped tables are replicated as normal by the main thread, while the binlog events for bootstrapped tables are queued and sent to the replication stream at the end of the bootstrap process.</p>
<h3 id="bootstrapping-data-format">Bootstrapping Data Format</h3>
<hr />
<ul>
<li>a bootstrap starts with an event of <code>type = "bootstrap-start"</code></li>
<li>then events with <code>type = "bootstrap-insert"</code> (one per row in the table)</li>
<li>then one event per <code>INSERT</code>, <code>UPDATE</code> or <code>DELETE</code> with standard event types i.e. <code>type = "insert"</code>, <code>type = "update"</code> or <code>type = "delete"</code> that occurred since the beginning of bootstrap</li>
<li>finally an event with <code>type = "bootstrap-complete"</code></li>
</ul>
<p>Here's a complete example:</p>
<pre><code>mysql&gt; create table fooDB.barTable(txt varchar(255));
mysql&gt; insert into fooDB.barTable (txt) values (&quot;hello&quot;), (&quot;bootstrap!&quot;);
mysql&gt; insert into maxwell.bootstrap (database_name, table_name) values (&quot;fooDB&quot;, &quot;barTable&quot;);
</code></pre>

<p>Corresponding replication stream output of table <code>fooDB.barTable</code>:</p>
<pre><code>{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;insert&quot;,&quot;ts&quot;:1450557598,&quot;xid&quot;:13,&quot;data&quot;:{&quot;txt&quot;:&quot;hello&quot;}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;insert&quot;,&quot;ts&quot;:1450557598,&quot;xid&quot;:13,&quot;data&quot;:{&quot;txt&quot;:&quot;bootstrap!&quot;}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;bootstrap-start&quot;,&quot;ts&quot;:1450557744,&quot;data&quot;:{}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;bootstrap-insert&quot;,&quot;ts&quot;:1450557744,&quot;data&quot;:{&quot;txt&quot;:&quot;hello&quot;}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;bootstrap-insert&quot;,&quot;ts&quot;:1450557744,&quot;data&quot;:{&quot;txt&quot;:&quot;bootstrap!&quot;}}
{&quot;database&quot;:&quot;fooDB&quot;,&quot;table&quot;:&quot;barTable&quot;,&quot;type&quot;:&quot;bootstrap-complete&quot;,&quot;ts&quot;:1450557744,&quot;data&quot;:{}}
</code></pre>

<h3 id="failure-scenarios">Failure Scenarios</h3>
<hr />
<p>If Maxwell crashes during bootstrapping the next time it runs it will rerun the bootstrap in its entirety - regardless of previous progress.
If this behavior is not desired, manual updates to the <code>bootstrap</code> table are required.
Specifically, marking the unfinished bootstrap row as 'complete' (<code>is_complete</code> = 1) or deleting the row.</p>
<script>
  jQuery(document).ready(function () {
    jQuery("table").addClass("table table-condensed table-bordered table-hover");
  });
</script></div>
        </div>

        

        <script src="../js/bootstrap-3.3.7.min.js"></script>
        <script src="../js/prettify-1.0.min.js"></script>
        <script src="../js/base.js"></script>
    </body>
    <script>
        jQuery(document).ready(function () {
            var shiftWindow = function() {
                scrollBy(0, -50)
            };

            //if (location.hash) shiftWindow();
            //window.addEventListener("hashchange", shiftWindow);

            jQuery("table").addClass("table table-condensed table-bordered table-hover");
            jQuery("#maxwell-header").append(
                jQuery("<img alt='The Daemon, maybe' src='/img/cyberiad_1.jpg' id='maxwell-daemon-image'>")
            );
        });
    </script>
</html>